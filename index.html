import React, { useState, useEffect, useRef } from 'react';
import { motion, AnimatePresence } from 'framer-motion';

const SaudiVirtualJourney = () => {
  const [currentDestination, setCurrentDestination] = useState(0);
  const [gameStarted, setGameStarted] = useState(false);
  const [gameCompleted, setGameCompleted] = useState(false);
  const [showHomepage, setShowHomepage] = useState(true);
  const [userAnswers, setUserAnswers] = useState<{[key: number]: string}>({});
  const [showAnswerFeedback, setShowAnswerFeedback] = useState(false);
  const [isAnswerCorrect, setIsAnswerCorrect] = useState(false);
  const [selectedAnswer, setSelectedAnswer] = useState('');
  const [language, setLanguage] = useState<'ar' | 'en'>('ar');

  const destinations = [
    {
      id: 1,
      name: {
        ar: 'Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø©',
        en: 'Makkah'
      },
      description: {
        ar: 'Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø© Ù‚Ø¨Ù„Ø© Ø§Ù„Ù…Ø³Ù„Ù…ÙŠÙ† ÙˆØ£Ù‚Ø¯Ø³ Ø¨Ù‚Ø§Ø¹ Ø§Ù„Ø£Ø±Ø¶.',
        en: 'Makkah, the direction of prayer for Muslims and the holiest place on Earth.'
      },
      question: {
        ar: 'ÙÙŠ Ø£ÙŠ Ø³Ù†Ø© ÙˆÙØ­Ø¯Øª Ø§Ù„Ù…Ù…Ù„ÙƒØ©ØŸ',
        en: 'In which year was the Kingdom unified?'
      },
      options: {
        ar: ['1920', '1932', '1950', '1971'],
        en: ['1920', '1932', '1950', '1971']
      },
      correctAnswer: '1932',
      image: "https://placeholder-image-service.onrender.com/image/800x500?prompt=Majestic%20view%20of%20Masjid%20al-Haram%20in%20Makkah%20with%20Kaaba%20in%20center&id=makkah-001"
    },
    {
      id: 2,
      name: {
        ar: 'Ø§Ù„Ø¹Ù„Ø§',
        en: 'AlUla'
      },
      description: {
        ar: 'Ø§Ù„Ø¹Ù„Ø§ Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„Ø­Ø¶Ø§Ø±Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©.',
        en: 'AlUla, the city of history and ancient civilization.'
      },
      question: {
        ar: 'Ø¥Ù„Ù‰ Ø£ÙŠ Ø­Ø¶Ø§Ø±Ø© ØªØ¹ÙˆØ¯ Ù…Ø¯Ø§Ø¦Ù† ØµØ§Ù„Ø­ØŸ',
        en: 'Which civilization does Madain Saleh belong to?'
      },
      options: {
        ar: ['Ø§Ù„ÙØ±Ø§Ø¹Ù†Ø©', 'Ø§Ù„Ø£Ù†Ø¨Ø§Ø·', 'Ø§Ù„Ø±ÙˆÙ…Ø§Ù†', 'Ø§Ù„Ø³Ø§Ø³Ø§Ù†ÙŠÙŠÙ†'],
        en: ['Pharaohs', 'Nabateans', 'Romans', 'Sassanids']
      },
      correctAnswer: 'Ø§Ù„Ø£Ù†Ø¨Ø§Ø·',
      image: "https://placeholder-image-service.onrender.com/image/800x500?prompt=Ancient%20Nabatean%20tombs%20in%20Madain%20Saleh%20AlUla%20desert%20landscape&id=alula-002"
    },
    {
      id: 3,
      name: {
        ar: 'Ø§Ù„Ø±ÙŠØ§Ø¶',
        en: 'Riyadh'
      },
      description: {
        ar: 'Ø§Ù„Ø¹Ø§ØµÙ…Ø© Ø§Ù„Ø­Ø¯ÙŠØ«Ø© ÙˆØ§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ù…Ø§Ù„ÙŠ ÙˆØ§Ù„ØªØ¬Ø§Ø±ÙŠ.',
        en: 'The modern capital and financial and commercial center.'
      },
      question: {
        ar: 'Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ø¨Ø±Ø¬ Ø§Ù„Ø£Ø´Ù‡Ø± ÙÙŠ Ø§Ù„Ø±ÙŠØ§Ø¶ØŸ',
        en: 'What is the name of the most famous tower in Riyadh?'
      },
      options: {
        ar: ['Ø¨Ø±Ø¬ Ø§Ù„ÙÙŠØµÙ„ÙŠØ©', 'Ø¨Ø±Ø¬ Ø§Ù„Ù…Ù…Ù„ÙƒØ©', 'Ø¨Ø±Ø¬ Ø±Ø§ÙØ§Ù„', 'Ø¨Ø±Ø¬ Ø§Ù„Ù…ÙŠØ§Ù‡'],
        en: ['Faisaliah Tower', 'Kingdom Tower', 'Rafal Tower', 'Water Tower']
      },
      correctAnswer: 'Ø¨Ø±Ø¬ Ø§Ù„Ù…Ù…Ù„ÙƒØ©',
      image: "https://placeholder-image-service.onrender.com/image/800x500?prompt=Kingdom%20Tower%20in%20Riyadh%20at%20night%20with%20modern%20city%20lights&id=riyadh-003"
    },
    {
      id: 4,
      name: {
        ar: 'Ù†ÙŠÙˆÙ…',
        en: 'NEOM'
      },
      description: {
        ar: 'Ù†ÙŠÙˆÙ… Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ ÙˆØ§Ù„Ø·Ø§Ù‚Ø© Ø§Ù„Ù…ØªØ¬Ø¯Ø¯Ø©.',
        en: 'NEOM, the city of the future and renewable energy.'
      },
      question: {
        ar: 'Ù…Ø§ Ø£Ø­Ø¯ Ù…Ø´Ø§Ø±ÙŠØ¹ Ø±Ø¤ÙŠØ© 2030 Ø§Ù„Ø¹Ù…Ù„Ø§Ù‚Ø©ØŸ',
        en: 'What is one of the giant projects of Vision 2030?'
      },
      options: {
        ar: ['Ø§Ù„Ù‚Ø¯ÙŠØ©', 'Ø§Ù„Ø¨Ø­Ø± Ø§Ù„Ø£Ø­Ù…Ø±', 'Ù†ÙŠÙˆÙ…', 'ÙƒÙ„ Ù…Ø§ Ø³Ø¨Ù‚'],
        en: ['Qiddiya', 'Red Sea', 'NEOM', 'All of the above']
      },
      correctAnswer: 'Ù†ÙŠÙˆÙ…',
      image: "https://placeholder-image-service.onrender.com/image/800x500?prompt=Futuristic%20city%20NEOM%20with%20modern%20architecture%20and%20sustainable%20design&id=neom-004"
    }
  ];

  const toggleLanguage = () => {
    setLanguage(language === 'ar' ? 'en' : 'ar');
  };

  const handleStartGame = () => {
    setShowHomepage(false);
    setGameStarted(true);
  };

  const handleStartQuiz = () => {
    setGameStarted(true);
  };

  const handleAnswerSelect = (answer: string) => {
    setSelectedAnswer(answer);
  };

  const handleAnswerSubmit = () => {
    if (!selectedAnswer) return;
    
    const currentDest = destinations[currentDestination];
    const isCorrect = selectedAnswer.trim().toLowerCase() === currentDest.correctAnswer.toLowerCase();
    
    setIsAnswerCorrect(isCorrect);
    setShowAnswerFeedback(true);
    setUserAnswers(prev => ({ ...prev, [currentDestination]: selectedAnswer }));
    
    if (isCorrect) {
      setTimeout(() => {
        setShowAnswerFeedback(false);
        setSelectedAnswer('');
        if (currentDestination < destinations.length - 1) {
          setCurrentDestination(prev => prev + 1);
        } else {
          setGameCompleted(true);
        }
      }, 2000);
    }
  };

  const handleRetry = () => {
    setShowAnswerFeedback(false);
    setSelectedAnswer('');
  };

  const handleRestartGame = () => {
    setCurrentDestination(0);
    setGameStarted(false);
    setGameCompleted(false);
    setShowHomepage(true);
    setUserAnswers({});
    setShowAnswerFeedback(false);
    setSelectedAnswer('');
  };

  const handleBackToHome = () => {
    setShowHomepage(true);
    setGameStarted(false);
    setGameCompleted(false);
  };

  const shareResults = () => {
    if (navigator.share) {
      navigator.share({
        title: language === 'ar' ? 'Ø±Ø­Ù„ØªÙŠ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©' : 'My Virtual Journey in Saudi Arabia',
        text: language === 'ar' 
          ? 'Ù…Ø¨Ø±ÙˆÙƒ! Ø£Ù†Ù‡ÙŠØª Ø±Ø­Ù„ØªÙŠ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙÙŠ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© ğŸŒŸ' 
          : 'Congratulations! I completed my virtual journey in Saudi Arabia ğŸŒŸ',
      });
    } else {
      alert(language === 'ar' 
        ? 'Ø´Ø§Ø±Ùƒ Ù†ØªÙŠØ¬ØªÙƒ Ù…Ø¹ Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡!' 
        : 'Share your results with friends!'
      );
    }
  };

  if (showHomepage) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-green-900 via-[#006C35] to-emerald-800" dir={language === 'ar' ? 'rtl' : 'ltr'}>
        {/* Navigation */}
        <nav className="flex justify-between items-center p-6">
          <div className="flex items-center">
            <img
              src="https://placeholder-image-service.onrender.com/image/50x50?prompt=Saudi%20Arabia%20national%20emblem&id=nav-emblem-007"
              alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©"
              className="w-10 h-10 mr-3"
            />
            <h1 className={`text-xl font-bold ${language === 'ar' ? 'font-[Cairo]' : 'font-Poppins'}`} style={{ color: '#CFAE62' }}>
              {language === 'ar' ? 'Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©' : 'Saudi Arabia'}
            </h1>
          </div>
          <button
            onClick={toggleLanguage}
            className="text-[#CFAE62] hover:text-white transition-colors duration-300 text-sm bg-white/10 backdrop-blur-sm px-3 py-1 rounded-full"
          >
            {language === 'ar' ? 'EN' : 'AR'}
          </button>
        </nav>

        {/* Hero Section */}
        <div className="text-center py-12 px-4">
          <motion.h1
            initial={{ opacity: 0, y: 30 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 1 }}
            className={`text-5xl font-bold mb-6 ${language === 'ar' ? 'font-[Cairo]' : 'font-Poppins'}`}
            style={{ color: '#CFAE62' }}
          >
            {language === 'ar' ? 'Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©' : 'Kingdom of Saudi Arabia'}
          </motion.h1>
          <motion.p
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.3, duration: 1 }}
            className="text-white text-xl max-w-4xl mx-auto leading-relaxed mb-8"
          >
            {language === 'ar' 
              ? 'Ø£Ø±Ø¶ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ø±ÙŠÙ‚ ÙˆØ§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ Ø§Ù„Ù…Ø´Ø±Ù‚. Ø§Ø³ØªÙƒØ´Ù Ø«Ù‚Ø§ÙØªÙ†Ø§ Ø§Ù„ØºÙ†ÙŠØ© ÙˆØªØ±Ø§Ø«Ù†Ø§ Ø§Ù„Ø¹Ø¸ÙŠÙ… ÙˆØ±Ø¤ÙŠØªÙ†Ø§ Ø§Ù„Ø·Ù…ÙˆØ­Ø© 2030.'
              : 'Land of ancient history and bright future. Explore our rich culture, great heritage, and ambitious Vision 2030.'}
          </motion.p>
        </div>

        {/* Information Sections */}
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 px-6 pb-12">
          {/* Culture Card */}
          <motion.div 
            initial={{ opacity: 0, y: 50 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.5 }}
            className="bg-white/10 backdrop-blur-md rounded-2xl p-6 border border-[#CFAE62]/30"
          >
            <div className="text-center mb-4">
              <img
                src="https://placeholder-image-service.onrender.com/image/80x80?prompt=Saudi%20cultural%20heritage%20and%20traditional%20clothing&id=culture-008"
                alt={language === 'ar' ? 'Ø§Ù„ØªØ±Ø§Ø« Ø§Ù„Ø«Ù‚Ø§ÙÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ' : 'Saudi cultural heritage'}
                className="mx-auto w-20 h-20 rounded-full"
              />
            </div>
            <h3 className={`text-xl font-bold mb-3 text-center ${language === 'ar' ? 'font-[Cairo]' : 'font-Poppins'}`} style={{ color: '#CFAE62' }}>
              {language === 'ar' ? 'Ø§Ù„Ø«Ù‚Ø§ÙØ© ÙˆØ§Ù„ØªØ±Ø§Ø«' : 'Culture & Heritage'}
            </h3>
            <p className="text-white text-sm text-center">
              {language === 'ar' 
                ? 'ØªØ¹Ø±Ù Ø¹Ù„Ù‰ ØªÙ‚Ø§Ù„ÙŠØ¯Ù†Ø§ Ø§Ù„ØºÙ†ÙŠØ© ÙˆØªØ±Ø§Ø«Ù†Ø§ Ø§Ù„Ø¹Ø±ÙŠÙ‚ Ø§Ù„Ø°ÙŠ ÙŠÙ…ØªØ¯ Ù„Ø¢Ù„Ø§Ù Ø§Ù„Ø³Ù†ÙŠÙ†'
                : 'Discover our rich traditions and heritage spanning thousands of years'}
            </p>
          </motion.div>

          {/* Tourism Card */}
          <motion.div 
            initial={{ opacity: 0, y: 50 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.7 }}
            className="bg-white/10 backdrop-blur-md rounded-2xl p-6 border border-[#CFAE62]/30"
          >
            <div className="text-center mb-4">
              <img
                src="https://placeholder-image-service.onrender.com/image/80x80?prompt=Saudi%20tourism%20landmarks%20and%20natural%20beauty&id=tourism-009"
                alt={language === 'ar' ? 'Ù…Ø¹Ø§Ù„Ù… Ø³ÙŠØ§Ø­ÙŠØ© Ø³Ø¹ÙˆØ¯ÙŠØ©' : 'Saudi tourism landmarks'}
                className="mx-auto w-20 h-20 rounded-full"
              />
            </div>
            <h3 className={`text-xl font-bold mb-3 text-center ${language === 'ar' ? 'font-[Cairo]' : 'font-Poppins'}`} style={{ color: '#CFAE62' }}>
              {language === 'ar' ? 'Ø§Ù„Ø³ÙŠØ§Ø­Ø©' : 'Tourism'}
            </h3>
            <p className="text-white text-sm text-center">
              {language === 'ar' 
                ? 'Ø§Ø³ØªÙ…ØªØ¹ Ø¨Ø¬Ù…Ø§Ù„ Ø§Ù„Ø·Ø¨ÙŠØ¹Ø© ÙˆØ§Ù„Ù…Ø¹Ø§Ù„Ù… Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠØ© ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø£Ù†Ø­Ø§Ø¡ Ø§Ù„Ù…Ù…Ù„ÙƒØ©'
                : 'Enjoy natural beauty and historical landmarks across the Kingdom'}
            </p>
          </motion.div>

          {/* Vision 2030 Card */}
          <motion.div 
            initial={{ opacity: 0, y: 50 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.9 }}
            className="bg-white/10 backdrop-blur-md rounded-2xl p-6 border border-[#CFAE62]/30"
          >
            <div className="text-center mb-4">
              <img
                src="https://placeholder-image-service.onrender.com/image/80x80?prompt=Saudi%20Vision%202030%20modern%20development%20projects&id=vision-010"
                alt={language === 'ar' ? 'Ø±Ø¤ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© 2030' : 'Saudi Vision 2030'}
                className="mx-auto w-20 h-20 rounded-full"
              />
            </div>
            <h3 className={`text-xl font-bold mb-3 text-center ${language === 'ar' ? 'font-[Cairo]' : 'font-Poppins'}`} style={{ color: '#CFAE62' }}>
              {language === 'ar' ? 'Ø±Ø¤ÙŠØ© 2030' : 'Vision 2030'}
            </h3>
            <p className="text-white text-sm text-center">
              {language === 'ar' 
                ? 'Ø§ÙƒØªØ´Ù Ù…Ø´Ø§Ø±ÙŠØ¹Ù†Ø§ Ø§Ù„Ø¹Ù…Ù„Ø§Ù‚Ø© Ø§Ù„ØªÙŠ ØªØ³Ù‡Ù… ÙÙŠ Ø¨Ù†Ø§Ø¡ Ù…Ø³ØªÙ‚Ø¨Ù„ Ù…Ø´Ø±Ù‚ Ù„Ù„Ù…Ù…Ù„ÙƒØ©'
                : 'Discover our giant projects contributing to building a bright future for the Kingdom'}
            </p>
          </motion.div>

          {/* Geography Card */}
          <motion.div 
            initial={{ opacity: 0, y: 50 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 1.1 }}
            className="bg-white/10 backdrop-blur-md rounded-2xl p-6 border border-[#CFAE62]/30"
          >
            <div className="text-center mb-4">
              <img
                src="https://placeholder-image-service.onrender.com/image/80x80?prompt=Saudi%20Arabia%20geographical%20map%20with%20regions&id=geo-011"
                alt={language === 'ar' ? 'Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©' : 'Saudi Arabia geographical map'}
                className="mx-auto w-20 h-20 rounded-full"
              />
            </div>
            <h3 className={`text-xl font-bold mb-3 text-center ${language === 'ar' ? 'font-[Cairo]' : 'font-Poppins'}`} style={{ color: '#CFAE62' }}>
              {language === 'ar' ? 'Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠØ§' : 'Geography'}
            </h3>
            <p className="text-white text-sm text-center">
              {language === 'ar' 
                ? 'Ø§Ø³ØªÙƒØ´Ù Ø§Ù„ØªÙ†ÙˆØ¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ Ø§Ù„Ù…Ø°Ù‡Ù„ Ø¨ÙŠÙ† Ø§Ù„ØµØ­Ø§Ø±ÙŠ ÙˆØ§Ù„Ø¬Ø¨Ø§Ù„ ÙˆØ§Ù„Ø³ÙˆØ§Ø­Ù„'
                : 'Explore amazing geographical diversity between deserts, mountains, and coasts'}
            </p>
          </motion.div>
        </div>

        {/* Start Quiz Button */}
        <motion.div
          initial={{ opacity: 0, y: 30 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 1.3 }}
          className="text-center pb-12"
        >
          <motion.button
            whileHover={{ scale: 1.05 }}
            whileTap={{ scale: 0.95 }}
            onClick={handleStartQuiz}
            className="bg-[#006C35] hover:bg-[#005a2a] text-white font-bold py-4 px-8 rounded-full text-lg transition-all duration-300 shadow-lg"
          >
            {language === 'ar' ? 'Ø§Ø®ØªØ¨Ø± Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ' : 'Test Your Knowledge'}
          </motion.button>
        </motion.div>
      </div>
    );
  }

  if (!gameStarted) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-green-900 via-[#006C35] to-emerald-800 flex items-center justify-center p-4" dir={language === 'ar' ? 'rtl' : 'ltr'}>
        <motion.div
          initial={{ opacity: 0, y: 50 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 1 }}
          className="bg-white/10 backdrop-blur-md rounded-3xl p-8 text-center max-w-2xl w-full border border-[#CFAE62]/30 shadow-2xl"
        >
          <motion.div
            initial={{ scale: 0 }}
            animate={{ scale: 1 }}
            transition={{ delay: 0.5, type: "spring", stiffness: 100 }}
            className="mb-6"
          >
            <img
              src="https://placeholder-image-service.onrender.com/image/200x200?prompt=Saudi%20Arabia%20national%20emblem%20with%20palm%20trees%20and%20crossed%20swords&id=emblem-005"
              alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©"
              className="mx-auto w-32 h-32 rounded-full border-4 border-[#CFAE62] shadow-lg"
            />
          </motion.div>
          
          <h1 className={`text-4xl font-bold mb-4 ${language === 'ar' ? 'font-[Cairo]' : 'font-Poppins'}`} style={{ color: '#CFAE62' }}>
            {language === 'ar' ? 'Ø§Ù„Ø±Ø­Ù„Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©' : 'Virtual Journey in Saudi Arabia'}
          </h1>
          
          <p className="text-white text-lg mb-8 leading-relaxed">
            {language === 'ar' 
              ? 'Ø§Ù†Ø·Ù„Ù‚ ÙÙŠ Ø±Ø­Ù„Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ø§ ØªÙÙ†Ø³Ù‰ Ø¹Ø¨Ø± Ø£Ø±Ø¶ Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„. Ø§Ø³ØªÙƒØ´Ù Ø§Ù„Ù…Ø¹Ø§Ù„Ù…ØŒ ØªØ¹Ù„Ù… Ø«Ù‚Ø§ÙØªÙ†Ø§ØŒ ÙˆØ§Ø®ØªØ¨Ø± Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ!'
              : 'Embark on an unforgettable virtual journey through the land of history and future. Explore landmarks, learn about our culture, and test your knowledge!'}
          </p>
          
          <motion.button
            whileHover={{ scale: 1.05 }}
            whileTap={{ scale: 0.95 }}
            onClick={handleStartGame}
            className="bg-[#006C35] hover:bg-[#005a2a] text-white font-bold py-4 px-8 rounded-full text-lg transition-all duration-300 shadow-lg mb-4"
          >
            {language === 'ar' ? 'Ø§Ø¨Ø¯Ø£ Ø±Ø­Ù„ØªÙƒ' : 'Start Your Journey'}
          </motion.button>
          
          <motion.button
            whileHover={{ scale: 1.05 }}
            whileTap={{ scale: 0.95 }}
            onClick={handleBackToHome}
            className="bg-[#0099CC] hover:bg-[#0088bb] text-white font-bold py-2 px-6 rounded-full transition-all duration-300 mr-2"
          >
            {language === 'ar' ? 'Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©' : 'Back to Home'}
          </motion.button>
          
          <button
            onClick={toggleLanguage}
            className="text-[#CFAE62] hover:text-white transition-colors duration-300 text-sm block mx-auto mt-4"
          >
            {language === 'ar' ? 'Switch to English' : 'Ø§Ù„ØªØºÙŠÙŠØ± Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©'}
          </button>
        </motion.div>
      </div>
    );
  }

  if (gameCompleted) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-[#006C35] to-[#0099CC] flex items-center justify-center p-4" dir={language === 'ar' ? 'rtl' : 'ltr'}>
        <motion.div
          initial={{ opacity: 0, scale: 0.8 }}
          animate={{ opacity: 1, scale: 1 }}
          transition={{ duration: 0.8 }}
          className="bg-white/10 backdrop-blur-md rounded-3xl p-8 text-center max-w-2xl w-full border border-[#CFAE62]/30 shadow-2xl"
        >
          <motion.div
            initial={{ rotate: 0 }}
            animate={{ rotate: 360 }}
            transition={{ duration: 2, repeat: Infinity, repeatType: "loop" }}
            className="mb-6"
          >
            <img
              src="https://placeholder-image-service.onrender.com/image/150x150?prompt=Gold%20trophy%20with%20Saudi%20flag%20colors%20and%20stars&id=trophy-006"
              alt="ÙƒØ£Ø³ Ø§Ù„ØªØªÙˆÙŠØ¬"
              className="mx-auto w-24 h-24"
            />
          </motion.div>
          
          <h2 className={`text-3xl font-bold mb-4 ${language === 'ar' ? 'font-[Cairo]' : 'font-Poppins'}`} style={{ color: '#CFAE62' }}>
            {language === 'ar' ? 'Ù…Ø¨Ø±ÙˆÙƒ!' : 'Congratulations!'}
          </h2>
          
          <p className="text-white text-xl mb-6 leading-relaxed">
            {language === 'ar' 
              ? 'Ø£Ù†Ù‡ÙŠØª Ø±Ø­Ù„ØªÙƒ ÙÙŠ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© ğŸŒŸ Ø£Ù†Øª Ø§Ù„Ø¢Ù† Ù…Ø³ØªÙƒØ´Ù Ø­Ù‚ÙŠÙ‚ÙŠ!'
              : 'You completed your journey in Saudi Arabia ğŸŒŸ You are now a true explorer!'}
          </p>
          
          <div className="flex flex-col sm:flex-row gap-4 justify-center mb-6">
            <motion.button
              whileHover={{ scale: 1.05 }}
              whileTap={{ scale: 0.95 }}
              onClick={handleRestartGame}
              className="bg-[#006C35] hover:bg-[#005a2a] text-white font-bold py-3 px-6 rounded-full transition-all duration-300 shadow-lg"
            >
              {language === 'ar' ? 'Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø±Ø­Ù„Ø©' : 'Restart Journey'}
            </motion.button>
            
            <motion.button
              whileHover={{ scale: 1.05 }}
              whileTap={{ scale: 0.95 }}
              onClick={shareResults}
              className="bg-[#0099CC] hover:bg-[#0088bb] text-white font-bold py-3 px-6 rounded-full transition-all duration-300 shadow-lg"
            >
              {language === 'ar' ? 'Ø´Ø§Ø±Ùƒ Ù†ØªÙŠØ¬ØªÙƒ' : 'Share Results'}
            </motion.button>
          </div>
          
          <button
            onClick={toggleLanguage}
            className="text-[#CFAE62] hover:text-white transition-colors duration-300 text-sm"
          >
            {language === 'ar' ? 'Switch to English' : 'Ø§Ù„ØªØºÙŠÙŠØ± Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©'}
          </button>
        </motion.div>
      </div>
    );
  }

  const currentDest = destinations[currentDestination];

  return (
    <div className="min-h-screen bg-gradient-to-br from-green-900 to-emerald-800 relative overflow-hidden" dir={language === 'ar' ? 'rtl' : 'ltr'}>
      {/* Background Image with Overlay */}
      <div className="absolute inset-0 z-0">
        <img
          src={currentDest.image}
          alt={language === 'ar' ? `ØµÙˆØ±Ø© Ø¨Ø§Ù†ÙˆØ±Ø§Ù…ÙŠØ© Ù„${currentDest.name.ar}` : `Panoramic view of ${currentDest.name.en}`}
          className="w-full h-full object-cover opacity-40"
        />
        <div className="absolute inset-0 bg-black/40"></div>
      </div>

      {/* Progress Bar */}
      <div className="absolute top-4 left-4 right-4 z-10">
        <div className="bg-white/20 rounded-full h-2">
          <motion.div
            initial={{ width: 0 }}
            animate={{ width: `${((currentDestination + 1) / destinations.length) * 100}%` }}
            transition={{ duration: 1 }}
            className="bg-[#CFAE62] h-2 rounded-full"
          />
        </div>
        <p className="text-white text-sm mt-2">
          {language === 'ar' ? `Ø§Ù„Ù…Ø­Ø·Ø© ${currentDestination + 1} Ù…Ù† ${destinations.length}` : `Stop ${currentDestination + 1} of ${destinations.length}`}
        </p>
      </div>

      {/* Language Toggle */}
      <button
        onClick={toggleLanguage}
        className="absolute top-4 right-4 z-10 text-[#CFAE62] hover:text-white transition-colors duration-300 text-sm bg-white/10 backdrop-blur-sm px-3 py-1 rounded-full"
      >
        {language === 'ar' ? 'EN' : 'AR'}
      </button>

      <div className="relative z-10 min-h-screen flex items-center justify-center p-4">
        <motion.div
          key={currentDestination}
          initial={{ opacity: 0, x: language === 'ar' ? 100 : -100 }}
          animate={{ opacity: 1, x: 0 }}
          exit={{ opacity: 0, x: language === 'ar' ? -100 : 100 }}
          transition={{ duration: 0.8 }}
          className="bg-white/10 backdrop-blur-md rounded-3xl p-8 max-w-2xl w-full border border-[#CFAE62]/30 shadow-2xl"
        >
          {/* Destination Image with Zoom Effect */}
          <motion.div
            initial={{ scale: 1.1 }}
            animate={{ scale: 1 }}
            transition={{ duration: 2 }}
            className="mb-6 rounded-2xl overflow-hidden shadow-lg"
          >
            <img
              src={currentDest.image}
              alt={language === 'ar' ? `Ù…Ù†Ø¸Ø± Ù„${currentDest.name.ar}` : `View of ${currentDest.name.en}`}
              className="w-full h-64 object-cover"
            />
          </motion.div>

          {/* Destination Info */}
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.5, duration: 0.8 }}
            className="text-center mb-6"
          >
            <h2 className={`text-3xl font-bold mb-2 ${language === 'ar' ? 'font-[Cairo]' : 'font-Poppins'}`} style={{ color: '#CFAE62' }}>
              {currentDest.name[language]}
            </h2>
            <p className="text-white text-lg leading-relaxed">
              {currentDest.description[language]}
            </p>
          </motion.div>

          {/* Question Section */}
          {!showAnswerFeedback ? (
            <motion.div
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              transition={{ delay: 1, duration: 0.8 }}
              className="bg-white/5 rounded-2xl p-6 border border-[#0099CC]/30"
            >
              <h3 className={`text-xl font-semibold mb-4 ${language === 'ar' ? 'font-[Cairo]' : 'font-Poppins'}`} style={{ color: '#0099CC' }}>
                {language === 'ar' ? 'Ø³Ø¤Ø§Ù„:' : 'Question:'}
              </h3>
              <p className="text-white text-lg mb-6">
                {currentDest.question[language]}
              </p>
              
              <div className="grid grid-cols-1 gap-3 mb-6">
                {currentDest.options[language].map((option, index) => (
                  <motion.button
                    key={index}
                    whileHover={{ scale: 1.02 }}
                    whileTap={{ scale: 0.98 }}
                    onClick={() => handleAnswerSelect(option)}
                    className={`p-4 rounded-xl text-left transition-all duration-300 ${
                      selectedAnswer === option 
                        ? 'bg-[#CFAE62] text-white border-2 border-[#CFAE62]' 
                        : 'bg-white/10 text-white border border-white/20 hover:border-[#CFAE62]/50'
                    }`}
                  >
                    {option}
                  </motion.button>
                ))}
              </div>
              
              <motion.button
                whileHover={{ scale: 1.05 }}
                whileTap={{ scale: 0.95 }}
                onClick={handleAnswerSubmit}
                disabled={!selectedAnswer}
                className={`w-full font-bold py-3 px-6 rounded-full transition-all duration-300 ${
                  selectedAnswer 
                    ? 'bg-[#006C35] hover:bg-[#005a2a] text-white' 
                    : 'bg-gray-400 text-gray-200 cursor-not-allowed'
                }`}
              >
                {language === 'ar' ? 'ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©' : 'Confirm Answer'}
              </motion.button>
            </motion.div>
          ) : (
            <motion.div
              initial={{ scale: 0.8 }}
              animate={{ scale: 1 }}
              className="text-center p-6 rounded-2xl bg-white/5 border border-[#CFAE62]/30"
            >
              <div className={`text-2xl font-bold mb-2 ${isAnswerCorrect ? 'text-green-400' : 'text-red-400'}`}>
                {isAnswerCorrect 
                  ? (language === 'ar' ? 'Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! âœ“' : 'Correct Answer! âœ“')
                  : (language === 'ar' ? 'Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©! âœ—' : 'Incorrect Answer! âœ—')
                }
              </div>
              {!isAnswerCorrect && (
                <div className="text-white mb-4">
                  {language === 'ar' ? 'Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©:' : 'Correct answer:'} {currentDest.correctAnswer}
                </div>
              )}
              {!isAnswerCorrect && (
                <motion.button
                  whileHover={{ scale: 1.05 }}
                  whileTap={{ scale: 0.95 }}
                  onClick={handleRetry}
                  className="bg-[#0099CC] hover:bg-[#0088bb] text-white font-bold py-2 px-6 rounded-full transition-all duration-300"
                >
                  {language === 'ar' ? 'Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰' : 'Try Again'}
                </motion.button>
              )}
            </motion.div>
          )}
        </motion.div>
      </div>
    </div>
  );
};

export default SaudiVirtualJourney;
