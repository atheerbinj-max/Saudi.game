import React, { useState } from 'react';
import { motion } from 'framer-motion';

const SaudiVirtualJourney = () => {
  const [currentDestination, setCurrentDestination] = useState(0);
  const [gameStarted, setGameStarted] = useState(false);
  const [gameCompleted, setGameCompleted] = useState(false);
  const [showHomepage, setShowHomepage] = useState(true);
  const [userAnswers, setUser Answers] = useState<{[key: number]: string}>({});
  const [showAnswerFeedback, setShowAnswerFeedback] = useState(false);
  const [isAnswerCorrect, setIsAnswerCorrect] = useState(false);
  const [selectedAnswer, setSelectedAnswer] = useState('');
  const [language, setLanguage] = useState<'ar' | 'en'>('ar');

  const destinations = [
    {
      id: 1,
      name: { ar: 'Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø©', en: 'Makkah' },
      description: {
        ar: 'Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø© Ù‚Ø¨Ù„Ø© Ø§Ù„Ù…Ø³Ù„Ù…ÙŠÙ† ÙˆØ£Ù‚Ø¯Ø³ Ø¨Ù‚Ø§Ø¹ Ø§Ù„Ø£Ø±Ø¶.',
        en: 'Makkah, the direction of prayer for Muslims and the holiest place on Earth.'
      },
      question: {
        ar: 'ÙÙŠ Ø£ÙŠ Ø³Ù†Ø© ÙˆÙØ­Ø¯Øª Ø§Ù„Ù…Ù…Ù„ÙƒØ©ØŸ',
        en: 'In which year was the Kingdom unified?'
      },
      options: {
        ar: ['1920', '1932', '1950', '1971'],
        en: ['1920', '1932', '1950', '1971']
      },
      correctAnswer: '1932',
      image: 'https://upload.wikimedia.org/wikipedia/commons/9/9e/Masjid_al-Haram_in_Makkah_2010.jpg'
    },
    {
      id: 2,
      name: { ar: 'Ø§Ù„Ø¹Ù„Ø§', en: 'AlUla' },
      description: {
        ar: 'Ø§Ù„Ø¹Ù„Ø§ Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„Ø­Ø¶Ø§Ø±Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©.',
        en: 'AlUla, the city of history and ancient civilization.'
      },
      question: {
        ar: 'Ø¥Ù„Ù‰ Ø£ÙŠ Ø­Ø¶Ø§Ø±Ø© ØªØ¹ÙˆØ¯ Ù…Ø¯Ø§Ø¦Ù† ØµØ§Ù„Ø­ØŸ',
        en: 'Which civilization does Madain Saleh belong to?'
      },
      options: {
        ar: ['Ø§Ù„ÙØ±Ø§Ø¹Ù†Ø©', 'Ø§Ù„Ø£Ù†Ø¨Ø§Ø·', 'Ø§Ù„Ø±ÙˆÙ…Ø§Ù†', 'Ø§Ù„Ø³Ø§Ø³Ø§Ù†ÙŠÙŠÙ†'],
        en: ['Pharaohs', 'Nabateans', 'Romans', 'Sassanids']
      },
      correctAnswer: 'Ø§Ù„Ø£Ù†Ø¨Ø§Ø·',
      image: 'https://upload.wikimedia.org/wikipedia/commons/3/3a/Mada%27in_Salih_01.jpg'
    },
    {
      id: 3,
      name: { ar: 'Ø§Ù„Ø±ÙŠØ§Ø¶', en: 'Riyadh' },
      description: {
        ar: 'Ø§Ù„Ø¹Ø§ØµÙ…Ø© Ø§Ù„Ø­Ø¯ÙŠØ«Ø© ÙˆØ§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ù…Ø§Ù„ÙŠ ÙˆØ§Ù„ØªØ¬Ø§Ø±ÙŠ.',
        en: 'The modern capital and financial and commercial center.'
      },
      question: {
        ar: 'Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ø¨Ø±Ø¬ Ø§Ù„Ø£Ø´Ù‡Ø± ÙÙŠ Ø§Ù„Ø±ÙŠØ§Ø¶ØŸ',
        en: 'What is the name of the most famous tower in Riyadh?'
      },
      options: {
        ar: ['Ø¨Ø±Ø¬ Ø§Ù„ÙÙŠØµÙ„ÙŠØ©', 'Ø¨Ø±Ø¬ Ø§Ù„Ù…Ù…Ù„ÙƒØ©', 'Ø¨Ø±Ø¬ Ø±Ø§ÙØ§Ù„', 'Ø¨Ø±Ø¬ Ø§Ù„Ù…ÙŠØ§Ù‡'],
        en: ['Faisaliah Tower', 'Kingdom Tower', 'Rafal Tower', 'Water Tower']
      },
      correctAnswer: 'Ø¨Ø±Ø¬ Ø§Ù„Ù…Ù…Ù„ÙƒØ©',
      image: 'https://upload.wikimedia.org/wikipedia/commons/7/7a/Kingdom_Centre_Tower_in_Riyadh.jpg'
    },
    {
      id: 4,
      name: { ar: 'Ù†ÙŠÙˆÙ…', en: 'NEOM' },
      description: {
        ar: 'Ù†ÙŠÙˆÙ… Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ ÙˆØ§Ù„Ø·Ø§Ù‚Ø© Ø§Ù„Ù…ØªØ¬Ø¯Ø¯Ø©.',
        en: 'NEOM, the city of the future and renewable energy.'
      },
      question: {
        ar: 'Ù…Ø§ Ø£Ø­Ø¯ Ù…Ø´Ø§Ø±ÙŠØ¹ Ø±Ø¤ÙŠØ© 2030 Ø§Ù„Ø¹Ù…Ù„Ø§Ù‚Ø©ØŸ',
        en: 'What is one of the giant projects of Vision 2030?'
      },
      options: {
        ar: ['Ø§Ù„Ù‚Ø¯ÙŠØ©', 'Ø§Ù„Ø¨Ø­Ø± Ø§Ù„Ø£Ø­Ù…Ø±', 'Ù†ÙŠÙˆÙ…', 'ÙƒÙ„ Ù…Ø§ Ø³Ø¨Ù‚'],
        en: ['Qiddiya', 'Red Sea', 'NEOM', 'All of the above']
      },
      correctAnswer: 'Ù†ÙŠÙˆÙ…',
      image: 'https://upload.wikimedia.org/wikipedia/commons/1/1a/NEOM_Logo.png' // NEOM logo as placeholder
    }
  ];

  const toggleLanguage = () => {
    setLanguage(language === 'ar' ? 'en' : 'ar');
  };

  const handleStartGame = () => {
    setShowHomepage(false);
    setGameStarted(true);
  };

  const handleAnswerSelect = (answer: string) => {
    setSelectedAnswer(answer);
  };

  const handleAnswerSubmit = () => {
    if (!selectedAnswer) return;
    const currentDest = destinations[currentDestination];
    const isCorrect = selectedAnswer.trim().toLowerCase() === currentDest.correctAnswer.toLowerCase();
    setIsAnswerCorrect(isCorrect);
    setShowAnswerFeedback(true);
    setUser Answers(prev => ({ ...prev, [currentDestination]: selectedAnswer }));
    if (isCorrect) {
      setTimeout(() => {
        setShowAnswerFeedback(false);
        setSelectedAnswer('');
        if (currentDestination < destinations.length - 1) {
          setCurrentDestination(prev => prev + 1);
        } else {
          setGameCompleted(true);
        }
      }, 2000);
    }
  };

  const handleRetry = () => {
    setShowAnswerFeedback(false);
    setSelectedAnswer('');
  };

  const handleRestartGame = () => {
    setCurrentDestination(0);
    setGameStarted(false);
    setGameCompleted(false);
    setShowHomepage(true);
    setUser Answers({});
    setShowAnswerFeedback(false);
    setSelectedAnswer('');
  };

  if (showHomepage) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-green-900 via-[#006C35] to-emerald-800 p-6 text-center" dir={language === 'ar' ? 'rtl' : 'ltr'}>
        <button onClick={toggleLanguage} className="absolute top-4 right-4 bg-white/20 rounded px-3 py-1 text-[#CFAE62] hover:text-white transition">{language === 'ar' ? 'EN' : 'AR'}</button>
        <h1 className="text-5xl font-bold mb-6" style={{ color: '#CFAE62', fontFamily: language === 'ar' ? 'Cairo, sans-serif' : 'Poppins, sans-serif' }}>
          {language === 'ar' ? 'Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©' : 'Kingdom of Saudi Arabia'}
        </h1>
        <p className="text-white max-w-3xl mx-auto mb-12 text-lg leading-relaxed">
          {language === 'ar'
            ? 'Ø£Ø±Ø¶ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ø±ÙŠÙ‚ ÙˆØ§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ Ø§Ù„Ù…Ø´Ø±Ù‚. Ø§Ø³ØªÙƒØ´Ù Ø«Ù‚Ø§ÙØªÙ†Ø§ Ø§Ù„ØºÙ†ÙŠØ© ÙˆØªØ±Ø§Ø«Ù†Ø§ Ø§Ù„Ø¹Ø¸ÙŠÙ… ÙˆØ±Ø¤ÙŠØªÙ†Ø§ Ø§Ù„Ø·Ù…ÙˆØ­Ø© 2030.'
            : 'Land of ancient history and bright future. Explore our rich culture, great heritage, and ambitious Vision 2030.'}
        </p>
        <button
          onClick={handleStartGame}
          className="bg-[#006C35] hover:bg-[#005a2a] text-white font-bold py-4 px-8 rounded-full text-lg transition duration-300 shadow-lg"
        >
          {language === 'ar' ? 'Ø§Ø®ØªØ¨Ø± Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ' : 'Test Your Knowledge'}
        </button>
      </div>
    );
  }

  if (gameCompleted) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-[#006C35] to-[#0099CC] flex flex-col items-center justify-center p-6 text-center" dir={language === 'ar' ? 'rtl' : 'ltr'}>
        <h2 className="text-4xl font-bold mb-4" style={{ color: '#CFAE62', fontFamily: language === 'ar' ? 'Cairo, sans-serif' : 'Poppins, sans-serif' }}>
          {language === 'ar' ? 'Ù…Ø¨Ø±ÙˆÙƒ!' : 'Congratulations!'}
        </h2>
        <p className="text-white text-xl mb-8 max-w-xl">
          {language === 'ar'
            ? 'Ø£Ù†Ù‡ÙŠØª Ø±Ø­Ù„ØªÙƒ ÙÙŠ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© ğŸŒŸ Ø£Ù†Øª Ø§Ù„Ø¢Ù† Ù…Ø³ØªÙƒØ´Ù Ø­Ù‚ÙŠÙ‚ÙŠ!'
            : 'You completed your journey in Saudi Arabia ğŸŒŸ You are now a true explorer!'}
        </p>
        <button
          onClick={handleRestartGame}
          className="bg-[#006C35] hover:bg-[#005a2a] text-white font-bold py-3 px-8 rounded-full mb-4 transition duration-300 shadow-lg"
        >
          {language === 'ar' ? 'Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø±Ø­Ù„Ø©' : 'Restart Journey'}
        </button>
      </div>
    );
  }

  const currentDest = destinations[currentDestination];

  return (
    <div className="min-h-screen bg-gradient-to-br from-green-900 to-emerald-800 relative p-6 text-center" dir={language === 'ar' ? 'rtl' : 'ltr'}>
      <button onClick={toggleLanguage} className="absolute top-4 right-4 bg-white/20 rounded px-3 py-1 text-[#CFAE62] hover:text-white transition">{language === 'ar' ? 'EN' : 'AR'}</button>
      <h2 className="text-3xl font-bold mb-4" style={{ color: '#CFAE62', fontFamily: language === 'ar' ? 'Cairo, sans-serif' : 'Poppins, sans-serif' }}>
        {currentDest.name[language]}
      </h2>
      <img
        src={currentDest.image}
        alt={currentDest.name[language]}
        className="mx-auto rounded-lg shadow-lg mb-6 max-h-64 object-cover"
      />
      <p className="text-white mb-6 max-w-xl mx-auto">{currentDest.description[language]}</p>

      {!showAnswerFeedback ? (
        <>
          <p className="text-white text-lg mb-4 font-semibold">{currentDest.question[language]}</p>
          <div className="max-w-xl mx-auto grid grid-cols-1 gap-4">
            {currentDest.options[language].map((option, idx) => (
              <button
                key={idx}
                onClick={() => setSelectedAnswer(option)}
                className={`py-3 rounded-lg border-2 font-semibold transition ${
                  selectedAnswer === option
                    ? 'bg-[#CFAE62] border-[#CFAE62] text-white'
                    : 'bg-white/10 border-white/30 text-white hover:border-[#CFAE62]'
                }`}
              >
                {option}
              </button>
            ))}
          </div>
          <button
            onClick={handleAnswerSubmit}
            disabled={!selectedAnswer}
            className={`mt-6 py-3 px-8 rounded-full font-bold transition duration-300 ${
              selectedAnswer
                ? 'bg-[#006C35] hover:bg-[#005a2a] text-white cursor-pointer'
                : 'bg-gray-500 text-gray-300 cursor-not-allowed'
            }`}
          >
            {language === 'ar' ? 'ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©' : 'Confirm Answer'}
          </button>
        </>
      ) : (
        <div className="mt-6 p-6 rounded-lg bg-white/10 border border-[#CFAE62] max-w-xl mx-auto">
          <p className={`text-2xl font-bold mb-4 ${isAnswerCorrect ? 'text-green-400' : 'text-red-400'}`}>
            {isAnswerCorrect ? (language === 'ar' ? 'Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! âœ“' : 'Correct Answer! âœ“') : (language === 'ar' ? 'Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©! âœ—' : 'Incorrect Answer! âœ—')}
          </p>
          {!isAnswerCorrect && (
            <p className="text-white mb-4">
              {language === 'ar' ? 'Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©: ' : 'Correct answer: '}
              {currentDest.correctAnswer}
            </p>
          )}
          {!isAnswerCorrect && (
            <button
              onClick={handleRetry}
              className="bg-[#0099CC] hover:bg-[#0088bb] text-white font-bold py-2 px-6 rounded-full transition duration-300"
            >
              {language === 'ar' ? 'Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰' : 'Try Again'}
            </button>
          )}
        </div>
      )}
    </div>
  );
};

export default SaudiVirtualJourney;
